!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function a(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e,t,a){return(t=i(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function s(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){l=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(l)throw i}}}}function i(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const r=(e,t,...a)=>{let n=(e,t)=>(t.forEach(((t,a)=>{e=e.replace("%"+(a+1)+"$",t)})),e);return void 0===window.i18n||void 0===window.i18n.state.locale.values[e]?n(e,a):n(t(window.i18n.state.locale.values[e]),a)},l=e=>0===(e=String(e)).length?"":e.replace(/[&<>'"]/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[e]))),c=(e,...t)=>{if(0===(e=String(e)).length)return"";return r(e,(e=>e.replace(/[<>'"]/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[e])))),...t)},d=e=>0===(e=String(e)).length?"":e.replace(/[&<>'"]/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[e]))),u=(e,...t)=>{if(0===(e=String(e)).length)return"";return r(e,(e=>e.replace(/[&<>'"]/g,(e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[e])))),...t)},p=()=>{let e=document.querySelector(".loader");e&&(e.style.display="block")},m=()=>{let e=document.querySelector(".loader");e&&(e.style.display="none")},v=e=>{let t=new URLSearchParams(window.location.search),a=t.get("sid")?t.get("sid"):"",n=-1==e.indexOf("?")?"?sid="+a:"&sid="+a;return e+n},y=()=>{let e=new URLSearchParams(window.location.search);return e.get("sid")?e.get("sid"):""},f=e=>{let t=e+"=",a=decodeURIComponent(document.cookie).split(";");for(let e=0;e<a.length;e++){let n=a[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""},h=()=>{let e=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,t=window.location.hostname+"/"+y()+"/"+f("locale");return t!=f("check")&&(e=0,console.log("refresh")),((e,t,a)=>{let n="";if(a){let e=new Date;e.setTime(e.getTime()+24*a*60*60*1e3),n=";expires="+e.toUTCString()}document.cookie=e+"="+(escape(t)||"")+n+";path=/;domain=.kenzap.cloud"})("check",t,5),e};f("kenzap_api_key"),f("locale")&&f("locale"),h(),f("kenzap_token"),y();const g=e=>{if(console.log(e),isNaN(e.code)){let t=e;try{t=JSON.stringify(t)}catch(e){}let a=new URLSearchParams;return a.append("cmd","report"),a.append("sid",y()),a.append("token",f("kenzap_token")),a.append("data",t),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:a}),void alert("Can not connect to Kenzap Cloud")}if(401===e.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(e.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+encodeURIComponent(window.location.href)}else alert(e.reason)},b=(e,t)=>{if(document.querySelector(e))for(let a of document.querySelectorAll(e))a.removeEventListener("click",t,!0),a.addEventListener("click",t,!0)},w=e=>{let t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)},S=e=>{if(!document.querySelector(".toast")){let e='\n        <div class="toast-cont position-fixed bottom-0 p-2 m-4 end-0 align-items-center" style="z-index:10000;">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>';document.querySelector("body > div")&&document.querySelector("body > div").insertAdjacentHTML("afterend",e)}let t=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML=e,t.show()};var x=function(){var e=new URLSearchParams(window.location.search),t=e.get("page")?e.get("page"):1;return parseInt(t)},k=function(e,t,a){if(void 0!==t){var n=t.limit+t.offset;n>t.total_records&&(n=t.total_records),document.querySelector("#listing_info").innerHTML=e("Showing %1$ to %2$ of %3$ entries",1+t.offset,n,t.total_records);var o=Math.ceil(t.total_records/t.limit);document.querySelector("#listing_paginate").style.display=o<2?"none":"block";var i=x(),r='<ul class="pagination d-flex justify-content-end pagination-flat mb-0">';r+='<li class="paginate_button page-item previous" id="listing_previous"><a href="#" aria-controls="order-listing" data-type="prev" data-page="0" tabindex="0" class="page-link"><span aria-hidden="true">&laquo;</span></li>';for(var l=0;l<o;)(++l>=i-3&&l<=i||l<=i+3&&l>=i)&&(r+='<li class="paginate_button page-item '+(i==l?"active":"")+'"><a href="#" aria-controls="order-listing" data-type="page" data-page="'+l+'" tabindex="0" class="page-link">'+l+"</a></li>");r+='<li class="paginate_button page-item next" id="order-listing_next"><a href="#" aria-controls="order-listing" data-type="next" data-page="2" tabindex="0" class="page-link"><span aria-hidden="true">&raquo;</span></a></li>',r+="</ul>",document.querySelector("#listing_paginate").innerHTML=r;var c,d=s(document.querySelectorAll(".page-link"));try{var u=function(){var e=c.value;e.addEventListener("click",(function(t){var n,s,i,r,l,c=parseInt(x()),d=c;switch(e.dataset.type){case"prev":(c-=1)<1&&(c=1);break;case"page":c=e.dataset.page;break;case"next":(c+=1)>o&&(c=o)}if(window.history.replaceState){var u=window.location.search;n="page",s=c,i=u,r=new RegExp("([?;&])"+n+"[^&;]*[;&]?"),u=((l=i.replace(r,"$1").replace(/&$/,"")).length>2?l+"&":"?")+(s?n+"="+s:""),window.history.replaceState("kenzap-cloud",document.title,window.location.pathname+u)}return d!=c&&a(),t.preventDefault(),!1}))};for(d.s();!(c=d.n()).done;)u()}catch(e){d.e(e)}finally{d.f()}}else document.querySelector("#listing_info").innerHTML=e("no records to display")},q=function(){return 0==window.location.host.indexOf("localhost")?"https://siteapi-dev.kenzap.cloud/":"https://siteapi.kenzap.cloud/"},_=a((function t(a){var o=this;e(this,t),n(this,"init",(function(){fetch(q()+"v1/?"+new URLSearchParams({cmd:"get_develop_layout",source:"layout",token:f("kenzap_token"),id:o.state.layoutEditId})).then((function(e){return e.json()})).then((function(e){e.success?(o.state.layoutResponse=e,o.render()):g(e),m()})).catch((function(e){g(e)}))})),n(this,"render",(function(){var e=o.state.layoutResponse.layout;o.state.modal=document.querySelector(".modal"),o.state.modalCont=new bootstrap.Modal(o.state.modal),o.state.modal.querySelector(".modal-dialog").classList.add("modal-fullscreen"),o.state.modal.querySelector(".modal-title").innerHTML=d(e.meta.title),o.state.modal.querySelector(".modal-footer").innerHTML='\n            <button type="button" class="btn btn-primary btn-update-layout">'.concat(u("Update"),'</button>\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(u("Cancel"),"</button>\n        "),o.state.modal.querySelector(".modal-body").innerHTML='\n        <div class="form-cont">\n            <div class="form-group mb-3">\n                <div class="row">\n                    <div class="col-md-6 grid-margin- stretch-card-">\n                        <div class="card-">\n                            <div class="card-body-">\n                                <h6 class="card-title">'.concat(u("HTML code"),'</h4>\n                                <textarea id="ace_html" class="ace-editor w-400" style="width:200px;height:200px;"> </textarea>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-6 grid-margin- stretch-card-">\n                        <div class="card-">\n                            <div class="card-body-">\n                                <h6 class="card-title">').concat(u("JSON data"),'</h4>\n                                <textarea id="ace_json" class="ace-editor w-400"> </textarea>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <br>\n                <div class="row">\n                    <div class="col-md-6 grid-margin- stretch-card-">\n                        <div class="card-">\n                            <div class="card-body-">\n                                <h6 class="card-title">').concat(u("JS code"),'</h4>\n                                <textarea id="ace_js" class="ace-editor w-400"> </textarea>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-6 grid-margin- stretch-card-">\n                        <div class="card-">\n                            <div class="card-body-">\n                                <h6 class="card-title">').concat(u("CSS code"),' <span class="cssclass"></span></h4>\n                                <textarea id="ace_css" class="ace-editor w-400"> </textarea>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <br>\n                <br>\n                <div class="row">\n                    <div class="col-md-12 grid-margin stretch-card- settings">\n                        <div class="card-">\n                            <div class="card-body-">\n                                <h6 class="card-title mb-3">').concat(u("Layout settings"),'</h4>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="title" class="col-sm-3 col-form-label">').concat(u("Title"),'</label>\n                                            <div class="col-sm-9">\n                                                <input id="title" type="text" class="text-input form-control  inps" value="" name="title">\n                                                <p class="card-description mt-2 form-text">').concat(u("Layout title used in search and for section preview"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="slug" class="col-sm-3 col-form-label">').concat(u("Slug"),'</label>\n                                            <div class="col-sm-9">\n                                                <input id="slug" type="text" class="text-input form-control  inps" value="" name="slug" disabled>\n                                                <p class="card-description mt-2 form-text">').concat(u("Used for template navigation"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="class" class="col-sm-3 col-form-label">').concat(u("CSS Class"),'</label>\n                                            <div class="col-sm-9">\n                                                <input id="class" type="text" class="text-input form-control  inps" value="').concat(l(e.meta.class),'" name="class" disabled>\n                                                <p class="card-description mt-2 form-text">').concat(u("Unique class to be prefixed for each CSS rule"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="template" class="col-sm-3 col-form-label">').concat(u("Template"),'</label>\n                                            <div class="col-sm-9">\n                                                <input id="template" type="text" class="text-input form-control  inps" value="" name="template" >\n                                                <p class="card-description mt-2 form-text">').concat(u("Parent template required to render this layout"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="version" class="col-sm-3 col-form-label">').concat(u("Version"),'</label>\n                                            <div class="col-sm-9">\n                                                <input id="version" type="text" class="text-input form-control  inps" value="" name="title">\n                                                <p class="card-description mt-2 form-text">').concat(u("Layout version control"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="description" class="col-sm-3 col-form-label">').concat(u("Description"),'</label>\n                                            <div class="col-sm-9">\n                                                <textarea id="description" type="text" class="text-input form-control  inps" value="" rows="2" name="description"></textarea>\n                                                <p class="card-description mt-2 form-text">').concat(u("Short layout description"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="keywords" class="col-sm-3 col-form-label">').concat(u("Keywords"),'</label>\n                                            <div class="col-sm-9">\n                                                <textarea id="keywords" type="text" class="text-input form-control  inps" value="" rows="3" name="keywords"></textarea>\n                                                <p class="card-description mt-2 form-text">').concat(u('Separate keywords by ",". Ex.: slider, banner, image'),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="title" class="col-sm-3 col-form-label">').concat(u("Repository"),'</label>\n                                            <div class="col-sm-9">\n                                                <input id="repository" type="text" class="text-input form-control  inps" value="" name="title">\n                                                <p class="card-repository mt-2 form-text">').concat(u("Link to Github repository where your layout is stored"),'</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="row" >\n                                    <div class="col-md-6">\n                                        <div class="form-group row">\n                                            <label for="preview" class="col-sm-3 col-form-label">').concat(u("Preview"),'</label>\n                                            <div class="col-sm-9">\n\n                                                <div class="file-search-img image-cont image-preview" data-id="preview_1" >\n                                                    <img id="i_preview_1" class="image" src="https://static.kenzap.com/layouts/image.jpg"/>\n                                                    <div id="p_preview_1" class="progress">\n                                                    <div class="progress-bar bg-primary progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                                                    </div>\n                                                </div>\n                                                <input id="u_preview_1" type="file" name="img[]" class="image-upload" data-iid="" data-id="preview_1"></input>\n                                                <input id="preview_1" data-val="false" type="hidden" class="image-input image-val inps" value=""></input>\n                                                \n                                                \x3c!-- <input id="preview" type="text" class="text-input form-control  inps" value="" name="preview"> --\x3e\n                                                <p class="card-description mt-2 form-text">Layout preview image 1200x742px</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                \n                <p class="form-text" >Need more help? <a target="_blank" href="https://kenzap.com/help-center/">Contact us here</a>.</p>            </div>\n        </div>'),b(".btn-update-layout",(function(e){o.update()})),o.state.modalCont.show(),o.listeners(),o.preview()})),n(this,"listeners",(function(){var e=o.state.layoutResponse.layout;if(document.querySelector("#ace_html")&&(o.state.editor.html=ace.edit("ace_html"),ace.config.set("basePath","https://account.kenzap.com/js/ace/"),o.state.editor.html.setTheme("ace/theme/monokai"),o.state.editor.html.getSession().setMode("ace/mode/html"),o.state.editor.html.setValue(e.html),document.getElementById("ace_html")),document.querySelector("#ace_js")&&(o.state.editor.js=ace.edit("ace_js"),o.state.editor.js.setTheme("ace/theme/monokai"),o.state.editor.js.getSession().setMode("ace/mode/javascript"),o.state.editor.js.setValue(e.js),document.getElementById("ace_js")),document.querySelector("#ace_json")){try{document.querySelector("#title").value=d(e.meta.title),document.querySelector("#version").value=d(e.meta.version),document.querySelector("#description").value=d(e.meta.description?e.meta.description:""),document.querySelector("#template").value=d(e.meta.template),document.querySelector("#repository").value=d(e.meta.repository?e.meta.repository:""),document.querySelector("#keywords").value=d(e.meta.keywords?e.meta.keywords:""),document.querySelector("#slug").value=d(e.meta.slug),document.querySelector("#class").value=d(e.meta.class)}catch(e){alert(e)}o.state.editor.json=ace.edit("ace_json"),o.state.editor.json.setTheme("ace/theme/monokai"),o.state.editor.json.getSession().setMode("ace/mode/json"),o.state.editor.json.setValue(JSON.stringify(e.extra,null,2)),document.getElementById("ace_json")}document.querySelector("#ace_css")&&(o.state.editor.css=ace.edit("ace_css"),o.state.editor.css.setTheme("ace/theme/monokai"),o.state.editor.css.getSession().setMode("ace/mode/css"),document.querySelector(".cssclass").innerHTML=e.meta.class,o.state.editor.css.setValue(e.css))})),n(this,"preview",(function(){var e=o.state.layoutResponse.layout,t=new Date,a="https://static.kenzap.com/preview/"+e.meta.template+"-"+e.meta.slug+"-600.jpeg?"+t.getTime(),n=new Image;n.src=a,n.onload=function(){n.width>400&&(e.meta.preview=!0,document.querySelector("#i_preview_1").setAttribute("src",a),document.querySelector("#preview_1").setAttribute("data-val",!0))},document.querySelector("#u_preview_1").setAttribute("data-iid",e.meta.template+"-"+e.meta.slug);var i=!1;if(!i){i=!0;var r,l=s(document.querySelectorAll(".image-preview"));try{for(l.s();!(r=l.n()).done;){r.value.addEventListener("click",(function(e){var t=document.querySelector("#u_"+this.dataset.id);return w(t),!1}))}}catch(e){l.e(e)}finally{l.f()}var c,d=s(document.querySelectorAll(".image-upload"));try{for(d.s();!(c=d.n()).done;){c.value.addEventListener("change",(function(e){if(this.files&&this.files[0]){var t=this,a=new FileReader;a.onload=function(e){var a,n,o,s,i=document.querySelector("#i_"+t.dataset.id);i&&i.setAttribute("src",e.target.result),a=t.dataset.id,n=t.dataset.iid,o=t.files[0],(s=new FormData).append("file",o),s.append("id",n),s.append("cmd","store_image"),s.append("type","cloud_preview"),s.append("lang","en"),s.append("token",f("kenzap_token")),document.querySelector("#p_"+a).style.display="block",document.querySelector("#p_"+a+" > div").style.width="0%",$.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total;document.querySelector("#p_"+a+" > div").style.width=parseInt(100*t)+"%",1==t&&setTimeout((function(){document.querySelector("#p_"+a).style.display="none"}),500)}}),!1),e.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total;document.querySelector("#p_"+a+" > div").style.width=parseInt(100*t)+"%",1==t&&setTimeout((function(){document.querySelector("#p_"+a).style.display="none"}),500)}}),!1),e},url:"https://fileapi.kenzap.com/v1/",type:"post",data:s,contentType:!1,processData:!1,success:function(e){JSON.parse(e).success&&document.querySelector("#preview_1").setAttribute("data-val",!0)}})},a.readAsDataURL(t.files[0])}}))}}catch(e){d.e(e)}finally{d.f()}}})),n(this,"update",(function(){if(!o.state.modal.querySelector(".btn-update-layout").dataset.loading){o.state.modal.querySelector(".btn-update-layout").dataset.loading=!0,o.state.modal.querySelector(".btn-update-layout").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+u("Loading..");try{o.state.layoutEditId;var e=JSON.parse(o.state.editor.json.getValue());null==e.data&&(e.data={}),e.data.version=document.querySelector("#version").value,e.data.title=document.querySelector("#title").value,e.data.slug=document.querySelector("#slug").value,e.data.description=document.querySelector("#description").value,e.data.preview=document.querySelector("#preview_1").dataset.val,e.data.template=document.querySelector("#template").value,e.data.keywords=document.querySelector("#keywords").value;var t={};t.version=document.querySelector("#version").value,t.title=document.querySelector("#title").value,t.description=document.querySelector("#description").value,t.preview=document.querySelector("#preview_1").dataset.val,t.keywords=document.querySelector("#keywords").value;var a=JSON.stringify(o.state.editor.html.getValue()),n=JSON.stringify(o.state.editor.css.getValue()),s=JSON.stringify(e),i=JSON.stringify(o.state.editor.js.getValue());p();var r=new FormData;r.append("cmd","save_develop_layout"),r.append("version",document.querySelector("#version").value.trim()),r.append("title",document.querySelector("#title").value.trim()),r.append("description",document.querySelector("#description").value.trim()),r.append("preview",document.querySelector("#preview_1").dataset.val.trim()),r.append("keywords",document.querySelector("#keywords").value.trim()),r.append("repository",document.querySelector("#repository").value.trim()),r.append("html",a),r.append("css",n),r.append("json",s),r.append("js",i),r.append("id",o.state.layoutEditId),r.append("token",f("kenzap_token")),fetch(q()+"v1/",{method:"POST",body:r}).then((function(e){return e.json()})).then((function(e){m(),o.state.modal.querySelector(".btn-update-layout").dataset.loading="",o.state.modal.querySelector(".btn-update-layout").innerHTML=u("Update"),e.success?(o.state.refresh.call(),o.state.modalCont.hide(),S(u("Layout updated"))):g(e)})).catch((function(e){g(e)}))}catch(e){console.log(e)}}})),this.state=a,this.state.editor=[],this.init()})),L=a((function t(){var a=this;e(this,t),n(this,"getData",(function(){a.state.firstLoad&&p();var e=document.querySelector(".search-cont input")?document.querySelector(".search-cont input").value:"";fetch(q()+"v1/?"+new URLSearchParams({cmd:"get_develop_lists",token:f("kenzap_token"),limit:a.state.limit,offset:e.length>0?0:x()*a.state.limit-a.state.limit,search:e})).then((function(e){return e.json()})).then((function(e){var t,n;console.log(e),e.locale=[],e.success?(a.render(e),a.initListeners(),a.initPagination(e),t=u("Pages 1.0.6 by %1$Kenzap%2$. ❤️ Licensed %3$GPLv3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/pages" target="_blank">',"</a>"),n=u("%1$Developer mode%2$",'<a class="text-muted" href="'.concat(v("/develop/"),'" target="_self">'),"</a>"),document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(t,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat(n,"</span>\n    </div>"),m(),a.state.firstLoad=!1):g(e)}))})),n(this,"authUser",(function(e){e.user&&e.user.success})),n(this,"html",(function(){a.state.firstLoad&&(document.querySelector("#contents").innerHTML='\n    <div class="container">\n\n        <div class="d-md-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary btn-add mt-3 mb-1 mt-md-0 mb-md-0" type="button">'.concat(u("Create layout"),'</button>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n                <div class="card border-white shadow-sm border-0">\n                    <div class="card-body p-0">\n                        <div class="no-footer">\n                            <div class="row">\n                                <div class="col-sm-12">\n                                    <div class="table-responsive">\n                                        <table class="table table-hover table-borderless align-middle table-striped- table-p-list mb-0" style="min-width: 800px;">\n                                            <thead>\n\n                                            </thead>\n                                            <tbody>\n\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="row my-2">\n                                <div class="col-sm-12 col-md-5 d-flex align-items-center">\n                                    <div class="dataTables_info mx-2 text-secondary fw-lighter " id="listing_info" role="status" aria-live="polite">&nbsp;</div>\n                                </div>\n                                <div class="col-sm-12 col-md-7">\n                                    <div class="dataTables_paginate paging_simple_numbers m-2" id="listing_paginate">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title"></h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    '))})),n(this,"render",(function(e){a.state.firstLoad&&((e=>{let t='<ol class="breadcrumb mt-2 mb-0">';for(let a of e)void 0===a.link?t+=`<li class="breadcrumb-item">${a.text}</li>`:t+=`<li class="breadcrumb-item"><a href="${a.link}">${a.text}</a></li>`;t+="</ol>",document.querySelector(".bc").innerHTML=t})([{link:v("https://dashboard.kenzap.cloud"),text:u("Home")},{link:v("/sites/"),text:u("Sites")},{text:u("Developer")}]),document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th class="text-center">\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" class="bi justify-content-end bi-search mb-1" viewBox="0 0 16 16" >\n                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                        </svg>\n                    </th>\n                    <th>\n                        <div class="search-cont input-group input-group-sm mb-0 justify-content-start">     \n                            <input type="text" placeholder="'.concat(u("Search"),'" class="form-control border-top-0 border-start-0 border-end-0 rounded-0" aria-label="').concat(u("Search products"),'" aria-describedby="inputGroup-sizing-sm" style="max-width: 200px;">\n                        </div>\n                        <span>').concat(u("Layout"),"</span>\n                    </th>\n                    <th>").concat(u("Status"),"</th>\n                    <th>").concat(u("Class"),"</th>\n                    <th>").concat(u("Updated"),"</th>\n                    <th></th>\n                </tr>")),(()=>{let e=new URLSearchParams(window.location.search);e.get("sid")&&e.get("sid")})(),a.state.settings=e.settings,a.state.layouts=e.layouts,e.layouts||(e.layouts=[]),0!=e.layouts.length?document.querySelector(".table tbody").innerHTML=e.layouts.map((function(e,t){return e.img="https://cdn.kenzap.com/loading.png",e.meta.preview||(e.meta.preview="false"),"true"==e.meta.preview&&(e.img="https://static.kenzap.com/preview/".concat(l(e.template+"-"+e.meta.slug),"-600.jpeg?")+c(e.meta.updated)),'\n            <tr>\n                <td>\n                    <div class="timgc">\n                        <a href="'.concat(v("/develop-edit/?id="+l(e.id)),'" class="edit-layout" data-id="').concat(l(e.id),'"><img src="').concat(e.img,'" data-srcset="').concat(e.img,'" class="img-fluid rounded" alt="').concat(c("Layout placeholder"),'" srcset="').concat(e.img,'" ></a>\n                    </div>\n                </td>\n                <td class="destt" style="max-width:250px;">\n                    <div>\n                        <a style="font-size:15px;color:#000E35;" class="edit-layout" href="').concat(v("/develop-edit/?id="+l(e.id)),'" data-id="').concat(l(e.id),'"><b>').concat(d(e.meta.title),'</b><i style="color:#9b9b9b;font-size:16px;margin-left:8px;display:none" title="Edit" class="mdi mdi-pencil menu-icon edit-cat"></i></a>\n                        <div style="font-size:12px;">').concat(d(e.template),' template</div>\n                    </div>\n                </td>\n                <td class="">\n                    ').concat(function(e,t){switch(t=parseInt(t)){case 0:return'<div class="badge bg-warning text-dark fw-light">'+e("Draft")+"</div>";case 1:return'<div class="badge bg-primary fw-light">'+e("Published")+"</div>";case 3:return'<div class="badge bg-secondary fw-light">'+e("Unpublished")+"</div>";default:return'<div class="badge bg-secondary fw-light">'+e("Drafts")+"</div>"}}(u,e.meta.status?e.meta.status:1),'\n                </td>\n                <td class="form-text text-danger">\n                    .').concat(u(e.meta.class),'\n                </td>\n                <td class="form-text">\n                    ').concat((a=e.meta.updated,n=new Date(1e3*parseInt(a)),o=n.toLocaleTimeString().split(":"),n.toLocaleDateString()+" "+o[0]+":"+o[1]),'\n                </td>\n                <td class="text-end">\n                    <div class="dropdown layoutActionsCont">\n                        <svg id="layoutActions').concat(l(t),'" data-bs-toggle="dropdown" data-boundary="viewport" aria-expanded="false" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-three-dots-vertical dropdown-toggle po" viewBox="0 0 16 16">\n                            <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>\n                        </svg>\n                        <ul class="dropdown-menu" aria-labelledby="layoutActions').concat(l(t),'">\n                            <li><a class="dropdown-item po edit-layout" href="#" data-id="').concat(l(e.id),'" data-index="').concat(l(t),'">').concat(u("Edit"),'</a></li>\n                            <li><a class="dropdown-item po download-template" href="#" data-title="').concat(d(e.meta.title),'" data-template="').concat(l(e.template),'" data-slug="').concat(l(e.meta.slug),'" data-class="').concat(l(e.meta.class),'" data-id="').concat(l(e.id),'" data-index="').concat(l(t),'">').concat(u("Download"),'</a></li>\n                            <li><a class="dropdown-item po d-none" href="#" data-id="').concat(l(e.id),'" data-index="').concat(l(t),'">').concat(u("Duplicate"),'</a></li>\n                            <li><a class="dropdown-item po d-none" href="#" data-type="query" data-id="').concat(l(e.id),'" data-_id="').concat(l(e.id),'" data-index="').concat(l(t),'">').concat(u("Query"),'</a></li>\n                            <li><hr class="dropdown-divider d-none-"></li>\n                            <li><a class="dropdown-item po remove-layout" href="#" data-type="cancel" data-id="').concat(l(e.id),'" data-index="').concat(l(t),'">').concat(u("Remove"),"</a></li>\n                        </ul>\n                    </div>\n                </td>\n            </tr>");var a,n,o})).join(""):document.querySelector(".table tbody").innerHTML='<tr><td colspan="6" class="text-center form-text fs-6 p-3">'.concat(u("no layouts to display"),"</td></tr>")})),n(this,"initListeners",(function(){b(".remove-layout",a.listeners.removeLayout),b(".view-pages",a.listeners.viewPages),b(".download-template",a.listeners.downloadTemplate),b(".edit-layout",a.listeners.editLayout),b(".table-p-list .bi-search",a.listeners.searchProductsActivate),a.state.firstLoad&&(b(".btn-add",a.addLayout),b(".btn-modal",a.listeners.modalSuccessBtn))})),n(this,"listeners",{downloadTemplate:function(e){e.preventDefault(),S(u("Downloading")),p();var t=e.currentTarget.dataset.class,a=e.currentTarget.dataset.slug,n=e.currentTarget.dataset.title,o=e.currentTarget.dataset.template;fetch("https://api.pages.app.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Kenzap-Locale":f("locale")?f("locale"):"en","Kenzap-Token":f("kenzap_token")},body:JSON.stringify({query:{download:{type:"download-template",class:t,title:n,slug:a,template:o,data:[]}}})}).then((function(e){return e.blob()})).then((function(e){var t,a,n;m(),e.size<100?e.text().then((function(e){JSON.parse(e).success||S(u("Can not download template"))})):(t=e,a=o+".zip",(n=document.createElement("a")).href=window.URL.createObjectURL(t),n.download=a,n.dispatchEvent(new MouseEvent("click")))})).catch((function(e){g(e)}))},removeLayout:function(e){e.preventDefault(),confirm(u("Completely remove this layout?"))&&(p(),fetch(q()+"v1/?"+new URLSearchParams({cmd:"remove_layout",token:f("kenzap_token"),id:e.currentTarget.dataset.id})).then((function(e){return e.json()})).then((function(e){e.success?(S(u("Layout removed")),a.getData()):g(e)})).catch((function(e){g(e)})))},viewPages:function(e){e.preventDefault()},editLayout:function(e){e.preventDefault(),a.state.layoutEditId=e.currentTarget.dataset.id,a.state.refresh=function(){a.getData()},a.state.editLayout=new _(a.state)},searchProductsActivate:function(e){e.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) span").style.display="none",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").style.display="flex",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont input").focus(),((e,t)=>{if(document.querySelector(e))for(let a of document.querySelectorAll(e))a.removeEventListener("keyup",t,!0),a.addEventListener("keyup",t,!0)})(".table-p-list thead tr th:nth-child(2) .search-cont input",a.listeners.searchProducts)},searchProducts:function(e){e.preventDefault(),a.getData()},modalSuccessBtn:function(e){a.listeners.modalSuccessBtnFunc(e)},modalSuccessBtnFunc:null}),n(this,"addLayout",(function(e){var t=document.querySelector(".modal"),n=new bootstrap.Modal(t);t.querySelector(".modal-title").innerHTML=u("Add Layout"),t.querySelector(".modal-footer").innerHTML='\n            <button type="button" class="btn btn-primary btn-add-layout">'.concat(u("Add"),'</button>\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(u("Cancel"),"</button>\n        "),t.querySelector(".modal-body").innerHTML='\n        <div class="form-cont">\n            <img style="width:100%;max-height:200px;" class="mb-3" src="/assets/img/new-entry.svg">\n            <div class="form-group mb-3">\n                <div class="form-group">\n                    <label for="tname">'.concat(u("Layout name"),'</label>\n                    <input id="tname" class="form-control tname" type="text" placeholder="Interactive Slider" />\n                    <p class="form-text" >').concat(u("Make it short. Once layout name is assigned it can not be changed."),'</p>\n                </div>\n                <div class="form-group">\n                    <label for="ttemp">').concat(u("Template (optional)"),'</label>\n                    <input id="ttemp" class="form-control ttemp" type="text" placeholder="universal" value="Universal" />\n                    <p class="form-text" >').concat(u("Specify this option if layout relies on Cloud Applicaton API."),'</p>\n                </div>\n                <p class="form-text" >Need more help? <a target="_blank" href="https://kenzap.com/help-center/">Contact us here</a>.</p>            </div>\n        </div>'),b(".btn-add-layout",(function(e){e.preventDefault();var o=t.querySelector(".tname").value;if(o.length<4)return alert("Please enter longer name"),!1;var s=o.replace(/[^\w\s]/gi,"");p(),fetch(q()+"v1/?"+new URLSearchParams({cmd:"create_layout",token:f("kenzap_token"),tname:s,ttemp:t.querySelector(".ttemp").value})).then((function(e){return e.json()})).then((function(e){e.success?(n.hide(),S(u("Layout created")),a.getData()):g(e)})).catch((function(e){g(e)}))})),n.show(),setTimeout((function(){return t.querySelector("#tname").focus()}),100)})),n(this,"initPagination",(function(e){k(__,e.meta_layouts,a.getData)})),this.state={firstLoad:!0,settings:{},limit:10},fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+f("kenzap_api_key"),"Kenzap-Locale":f("locale")?f("locale"):"en","Kenzap-Header":h(),"Kenzap-Token":f("kenzap_token"),"Kenzap-Sid":y()},body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar"],token:f("kenzap_token")},locale:{type:"locale",source:["extension"],key:"ecommerce"}}})}).then((function(e){return e.json()})).then((function(e){m(),e.success&&((e=>{if(e.header&&localStorage.setItem("header",e.header),e.cdn&&localStorage.setItem("cdn",e.cdn),!document.querySelector("#k-script")){let e=document.createElement("div");e.innerHTML=localStorage.getItem("header"),e=e.firstChild,document.body.prepend(e),Function(document.querySelector("#k-script").innerHTML).call("test")}e.locale&&window.i18n.init(e.locale)})(e),a.html(),a.getData())}))}));new L}();
